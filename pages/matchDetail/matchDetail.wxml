<!-- pages/matchDetail/matchDetail.wxml -->

<view class="match-detail-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <block wx:if="{{isLoading}}">
    <view class="loading-container">
      <van-loading type="spinner" size="36px" color="#1989fa" />
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
  </block>

  <!-- èµ›äº‹è¯¦æƒ…å†…å®¹ -->
  <block wx:elif="{{matchInfo}}">
    <!-- 2. èµ›äº‹å›¾ç‰‡ -->
    <view class="banner-container">
      <image class="banner-image" src="{{matchInfo.image || 'https://placehold.co/400x300/e9f1fa/1a73e8?text=Rugby+Match'}}" mode="widthFix"></image>
    </view>

    <!-- 3. èµ›äº‹æ ‡é¢˜ -->
    <view class="match-title">{{matchInfo.title || 'æœªè®¾ç½®æ ‡é¢˜'}}</view>

    <!-- 4. èµ›äº‹è¯¦ç»†ä¿¡æ¯ï¼ˆ2Ã—2çŸ©é˜µï¼‰ -->
    <view class="detail-info">
      <view class="info-grid">
        <view class="info-item">
          <van-icon name="calendar-o" class="info-icon" />
          <view class="info-value">{{matchInfo.date.year || ''}}å¹´{{matchInfo.date.month || ''}}æœˆ{{matchInfo.date.day || ''}}æ—¥</view>
        </view>
        <view class="info-item">
          <van-icon name="clock-o" class="info-icon" />
          <view class="info-value">{{matchInfo.time || 'æœªè®¾ç½®æ—¶é—´'}}</view>
        </view>
        <view class="info-item">
          <van-icon name="location-o" class="info-icon" />
          <view class="info-value">{{matchInfo.location || 'æœªè®¾ç½®åœ°ç‚¹'}}</view>
        </view>
        <view class="info-item">
          <van-icon name="user-o" class="info-icon" />
          <view class="info-value">{{matchInfo.category || 'æœªè®¾ç½®ç»„åˆ«'}}</view>
        </view>
      </view>
    </view>

    <!-- 5. æŠ¥åæŒ‰é’® -->
    <view class="register-section">
      <button class="register-btn" bindtap="onRegister">ç«‹å³æŠ¥å</button>
    </view>

    <!-- 6. èµ›ç¨‹å®‰æ’æ ‡é¢˜ -->
    <view class="section-title">
      <van-icon name="description-o" class="info-icon" />
      <view class="title-text">èµ›ç¨‹å®‰æ’</view>
    </view>

    <!-- 7. èµ›ç¨‹å®‰æ’å†…å®¹ -->
    <view class="schedule-section">
      <block wx:if="{{matchInfo.schedule && matchInfo.schedule.length > 0}}">
        <view class="schedule-item" wx:for="{{matchInfo.schedule}}" wx:key="index">
          <view class="schedule-left">
            <view class="schedule-phase">{{item.phase || 'é˜¶æ®µ'}}</view>
            <view class="schedule-time">{{item.time || 'æ—¶é—´å¾…å®š'}} Â· {{item.matches || 'å¾…å®š'}}</view>
          </view>
          <view class="schedule-date">{{item.date || 'æ—¥æœŸå¾…å®š'}}</view>
        </view>
      </block>
      <view wx:else class="empty-text">æš‚æ— èµ›ç¨‹å®‰æ’</view>
    </view>

    <!-- 8. å‚èµ›é˜Ÿä¼æ ‡é¢˜ -->
    <view class="teams-header">
      <view class="teams-title">
        <van-icon name="award-o" class="info-icon" />
        å‚èµ›é˜Ÿä¼
        </view>
      <view class="teams-count">å…±{{matchInfo.teams ? matchInfo.teams.length : 0}}æ”¯é˜Ÿä¼</view>
    </view>

    <!-- 9. å‚èµ›é˜Ÿä¼åˆ—è¡¨ï¼ˆ3åˆ—æ’å¸ƒï¼‰ -->
    <view class="teams-section">
      <block wx:if="{{matchInfo.teams && matchInfo.teams.length > 0}}">
        <view class="teams-grid">
          <view class="team-item" wx:for="{{matchInfo.teams}}" wx:key="index">
            <view class="team-icon">{{item.substring(0, 1)}}</view>
            <view class="team-name">{{item}}</view>
          </view>
        </view>
      </block>
      <view wx:else class="empty-text">æš‚æ— å‚èµ›é˜Ÿä¼</view>
    </view>
  </block>

  <!-- æ— æ•°æ®çŠ¶æ€ -->
  <block wx:else>
    <view class="empty-container">
      <view class="empty-icon">ğŸ“…</view>
      <view class="empty-text">æš‚æ— èµ›äº‹ä¿¡æ¯</view>
      <button class="back-btn" bindtap="onBack">è¿”å›é¦–é¡µ</button>
    </view>
  </block>
</view>